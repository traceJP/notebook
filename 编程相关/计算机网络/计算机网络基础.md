# 一、概念：

- 计算机网络=通信技术+计算机技术

（1）什么是计算机网络：计算机网络是通信技术与计算机技术紧密结合的产物

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image002.gif)

- 计算机网络就是一种通信网络：信源和信宿一般指的就是计算机终端，发送和接收的地方

（2）计算机网络定义：定义:计算机网络就是互连的、自治的计算机集合。

- 自治：无主从关系

- 互连：互联互通

（3）Internet简介：

1. Internet是全球最大的互联网络：由数以百万计的互联的计算设备集合：主机（终端和应用），通信链路（光纤等），分组交换转发分组（路由器交换机等）

2. internet是为网络应用提供通信服务的通信基础设施：如Web、email、网络游戏等

3. 为网络应用提供应用编程接口（API）：如支持应用程序“连接Internet”，发送\接收数据，提供类似邮箱系统的数据传输服务。

（4）网络协议简介：

- l 协议：协议是计算机网络有序运行的重要保证。如同交通系统一样，仅仅是有硬件是不够的，还需要一个规则，才能使交通系统不混乱

- 网络协议：网络协议(network protocol)，简称为协议，是为进行网络中的数据交换而建立的规则、标准或约定。

    - 协议规定了通信实体之间所交换的消息的格式、意义、顺序以及针对收到信息或发生的事件所采取的“动作”(actions)。

（5）作为协议的三要素

- 语法(Syntax)

    - 数据与控制信息的结构或格式

    - 信号电平

- 语义(Semantics)

    - 需要发出何种控制信息

    - 完成何种动作以及做出何种响应

    - 差错控制

- 时序(Timing）

    - 事件顺序

    - 速度匹配

(1) 语义：语义是解释控制信息每个部分的意义。它规定了需要发出何种控制信息，以及完成的动作与做出什么样的响应。    ————做什么

(2) 语法：语法是用户数据与控制信息的结构与格式，以及数据出现的顺序。      ————怎么做

(3) 时序：时序是对事件发生顺序的详细说明。（也可称为“同步”）。    ————做的顺序

（6）协议是计算机网络的重要内容：

1. 协议规范了网络中所有信息发送和接收过程，如TCP、IP、HTTP、Skype、802.11等协议

2. Internet协议标准：RFC文档（Request for Comments）（请求评价）

# 二、计算机网络结构：

1. 网络边缘：

a)   主机（端系统）：运行网络应用程序，如Web。

b)   客户/服务器（client/server）应用模型：客户发送请求，接收服务器响应。谁主动发起通信谁就是客户。

c)   对等（peer-peer，p2p）应用模型：无专用服务器，通信在对等实体之间直接进行，如qq微信。

2. 接入网络，物理介质：

a)   有线或无线通信链路：如住宅接入网络，机构接入网络等，如图为数字用户线路（DSL）

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image004.gif)

3. 网络核心（核心网络）：

a)   互联的路由器（或分组转发设备）：即网络核心的关键功能：路由+转发

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image006.gif)

b)   网络的网络：这里其实指的是Internet结构（所谓Internet就是指很多网络互联所构成的网络）：

  i. 端系统通过接入ISP（access lSPs）连接到Internet，然后进一步互联，这样任意两个主机才可以互相发送分组。
    
  ii.当前的Internet的结构无法给出精确的描述。
    
  iii.  如图，粗略的描述全球的Internet结构，可以以ISP接入网络的级别进行分组。即网络的拓扑结构。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image008.gif)

# 三、数据交换：

- 定义：数据交换（Data Switching）是指在多个数据终端设备（DTE）之间，为任意两个终端设备建立数据通信临时互连通路的过程。

- 为什么需要数据交换：因为在Internet中，不可能将每个终端都单独相连，而最佳的方式是终端与终端之间通过许多个交换设备的数据交换，从而相互连接。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image010.gif)

- 数据交换的类型：电路交换、报文交换、分组交换。

（1）电路交换：

- 电路交换：最典型的如电话网络：

    - 电路交换的三个阶段：建立连接（呼叫/电路建立）、通信、释放连接（拆除电路）。

    - 特点：独占资源（建立连接后，这条线路不能被第三方使用，除非线路被拆除）。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image012.gif)

（1.1）多路复用技术：

- 电路交换所造成的资源独占会导致资源的浪费，使用多路复用技术即可共享中继线（共享线道）。

- 多路复用(Multiplexing)：链路/网络资源（如带宽）划分为“资源片”

    - 将资源片分配给各路“呼叫”(calls)

    - 每路呼叫独占分配到的资源片进行通信

    - 资源片可能“闲置”(idle)(无共亨)

- 典型多路复用方法:

    - 频分多路复用( frequency division multiplexing-FDM)：如电视机的信号线，根据不同的频率，看不同的频道。

    - 时分多路复用( time division multiplexing-TDM)：把信道的使用时间划分为等长的时间（TDM帧（TDM帧又划分为时隙）），每个用户分别占用自己的时隙，而时隙周期性的出现，以此复用信道。

    - 波分多路复用(Wavelength division multiplexing-WDM)：波分复用就是光的频分复用（根据光的波长不同进行复用）。

    - 码分多路复用( Code division multiplexing-CDM)：给每个用户分配一个唯一的m bit（码片序列chipping sequence），再用码片的序列对原始数据进行编码，根据码片的算法（此时信道里的数据是所有数据的一个叠加向量）来区别（解码）各个用户的数据。码分多路复用现广泛运用于蜂窝网等。

（2）报文交换：

- 报文：源（应用）发送信息整体，由路由转发设备进行整体接收，然后再将其转发出去，直到目的地。常用于上世纪电报。

- 优缺点：

    - 优点：无

    - 缺点 ：因为路由转发设备需要完整的接收整个报文，所以路由设备至少需要和报文一样大的缓存，这对路由设备要求极高，且报文交换整体速度缓慢。

（3）分组交换：

- 分组：报文拆出来的一系列相对较小的数据包。该数据包由头部+数据组成。常用于现在的网络交换。

    - 分组交换需要报文的拆分与重组。这其中会产生额外的开销（比单独的一个报文多了许多分组的头部信息）

- 优缺点：

    - 优点：效率远远高于报文交换

    - 缺点：头部信息使整个报文变得更大了，对路由设备的缓存要求不高。

（4）对比：

- 报文交换相当于一次需要发送一个整体，而中继设备需要接收到整个内容才能再次转发出去，这一过程会利用不到后面的一些中继设备，使得整体的效率较低；而分组交换为了解决这一问题，将一个整体的报文拆分成许多部分，这使得这些部分可以单独的一个一个的传输（当第二个分组从设备转发到第二个设备后，第一个分组可以同步进行转发到第三个设备中），到了目的地再将其组装起来，但是这虽然解决了效率问题，但增加了报文的额外开销（以内存换时间）。

- 报文交换与分组交换均采用存储-转发交换方式。

- 电路交换与分组交换对比：两者之间并没有明显的最优，因为分组交换是适用于突发数据传输网络。这种突发型的数据传输，不需要呼叫建立而是直接发送报文分组，所以可能会产生拥塞。

    - 突发：如在浏览网页时，仅仅是一开始加载网页需要使用到网络。而在打电话看视频时，需要源源不断的使用网络，这种就是非突发型的。

    - 拥塞(congestion）：分组延迟和丢失需要协议处理可靠数据传输和拥塞控制。

# 四、计算机网络的性能：

（1）速率：速率即数据率(data rate)或称数据传输速率或比特率(bit rate)

- 单位时间（秒）传输信息（比特）量。

- 计算机网络中最重要的一个性能指标。

- 单位: b/s（或bps）、 kbls、Mbls、Gb/s。

- 速率往往是指额定速率或标称速率。

（2）带宽：“带宽”(bandwidth)原本指信号具有的频带宽度，即最高频率与最低频率之差，单位是赫兹（Hz）

- 网络的“带宽”通常是数字信道所能传送的“最高数据率”，单位: b/s (bps)

- 常用的带宽单位：kb/s、Mb/s、Gb/s、Tb/s

 （3）延迟（时延）：

- 分组交换产生的延迟与丢包：

    - 当分组正在排队等候其他输出时，产生延迟。

    - 当分组达到速率超出链路容量时，产生丢包。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image014.gif)

- l 四种导致延迟的可能：

1. d-proc：结点处理延迟（nodal processing delay）

a)   差错检测

b)   确定输出链路

c)   延迟通常<毫秒级

2. d-qucue：排队延迟（queueing delay）

a)   等待输出链路可用

b)   延迟取决于路由器拥塞程度

3. d-trans：传输延迟（transmission delay）（相当于车辆通过收费站的时间）

a)   L：分组长度(bits)

b)   R：链路带宽(bps)

c)   d-trans=L/R

d)   流量强度（traffic intensity）=La/R （a：平均分组达到的速率）

  i.   La/R趋近于0：平均排队延迟很小

  ii.  La/R趋近于1：平均排队延迟很大

  iii. La/R>1：超出服务能力，平均排队延迟无限大

4. d-prop：传播延迟（propagation delay）（相当于车辆整个高速的时间）

a)   d：物理链路长度

b)   s：信号传播速度（~2×10^8m/sec）

c)   d-prop=d/s

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image016.gif)

- 根据这四种延迟的相加可以得到最终传输过程中的延迟d_nodal=d_proc+d_queue+d_trans+d_prop


（3.1）时延带宽积：

- 时延带宽积 = 传播时延 * 带宽 = d-prop * R (bits) 

- 链路的时延带宽积又称为以比特为单位的链路长度

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image018.gif)

（3.2）分组丢失（丢包）：

- 队列缓存容量有限

- 分组到达已满队列将被丢弃(即丢包)

- 丢弃分组可能由前序结点或源重发（也可能不重发）

- 丢包率 = 丢包数 / 已发分组总数

（4）吞吐量（率）（Throughput）：

- 表示在发送端与接收端之间传送数据速率(b/s)

    - 即时吞吐量：给定时刻的速率

    - 平均吞吐量：一段时间的平均速率

- 吞吐量的计算（瓶颈链路）：

    - 端到端的路径上，限制端到端吞吐量的链路。即当一个水流通过两个不同大小的水管时，理论上取决于最小的水管。

# 五、计算机网络体系结构：

- 计算机网络是一个非常复杂的系统，涉及许多组成部分：如主机路由器各种链路应用协议硬件软件等。而描述这些组成部分相互配合的就是计算机网络体系结构。

- 复杂系统的分层结构：每层完成一种（一类）特定的功能。

    - 每层依赖底层提供的服务，通过层内动作完成相应功能。

（1）概述：

- 网络体系结构是从功能上描述计算机网络结构。

- 计算机网络体系结构简称网络体系结构(network architecture)是分层结构。

- 每层遵循某个/些网络协议完成本层功能。

- 计算机网络体系结构是计算机网络的各层及其协议的集合。

- 体系结构是一个计算机网络的功能层次及其关系的定义。

- 体系结构是抽象的。

（1.1）分层结构的优点：

- 结构清晰，有利于识别复杂系统的部件及其关系：分层的参考模型(reference model )

- 模块化的分层易于系统更新、维护

- 任何一层服务实现的改变对于系统其它层都是透明的，如面向对象设计程序的封装

- 有利于标准化

（1.2）分层网络体系结构的基本概念：

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image020.gif)

- 实体(entity)表示任何可发送或接收信息的硬件或软件进程。

- 协议是控制两个对等实体进行通信的规则的集合，协议是“水平的”。

- 任一层实体需要使用下层服务，遵循本层协议，实现本层功能，向上层提供服务，服务是“垂直的”。

- 下层协议的实现对上层的服务用户是透明的。

- 同系统的相邻层实体间通过接口进行交互，通过服务访问点SAP(Service Access Point)，交换原语，指定请求的特定服务。


（2）OSI参考模型：

1、概念：

- 开放系统互连(OSI)参考模型是由国际标准化组织(ISO)于1984年提出的分层网络体系结构模型

- 目的是支持异构网络系统的互联互通

- 异构网络系统互连的国际标准

- 理解网络通信的最佳学习工具(理论模型）：理论成功，市场失败

- OSI参考模型一共分为7层，每层完成特定的网络功能：

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image022.gif)

2、OSI参考模型解释的通信过程：

- 实线：物理通信；其中上面4层协议是端-端层（end-end）；

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image024.gif)

2.1、OSI参考模型的数据封装过程：

- 每一层通过对用户数据加头加尾将数据一步一步封装，然后传输再解析。

- 为什么需要数据封装：

    - 增加控制信息：构造协议数据单元(PDU)

    - 控制信息主要包括:

        - 地址（Address）:标识发送端/接收端

        - 差错检测编码（Error-detecting code）:用于差错检测或纠正

        - 协议控制（Protocol control):实现协议功能的附加信息，如:优先级(priority）、服务质量（QoS）、和安全控制等

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image026.gif)


**2.2、第一层物理层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image028.gif)

- 负责将二进制数据通过物理介质从发送端交付给接收端。

- 接口特性：机械特性（接口形状）、电气特性（电压大小等）、功能特性（作什么用）、规程特性（过程特性：需要遵循什么规则）

- 比特编码：用什么表示0，什么表示1

- 数据率：以多快的速度发数据

- 比特同步（时钟同步）：发送设备和接收设备之间同步

- 传输模式：

    - 单工（Simplex）：单向传输，如电视只能接收信号。

    - 半双工（half-duplex）：交替通信，如果要发数据则该时间内不能接收数据，反之亦然。如对讲机：在听话过程中就不能说话。

    - 全双工（full-duplex）：可以同时发数据和收数据，一般采用双信道。


**2.3、第二层数据链路层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image030.gif)

- 负责结点-结点（node-to-node）数据传输。

- 组帧（成帧）（Framing）：加头加尾。可以将具体数据切分出来。

- 物理寻址（Physical addressing）：注意寻找地址是在数据链路层进行的，因为物理层中的数据只有0和1。 

- 在帧头中增加发送端和/或接收端的物理地址标识数据帧的发送端和/或接收端

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image032.gif)

- 流量控制（Flow control）：避免淹没接收端：接收的数据还没有被中继到下一个地方时，上一个数据又发，导致中继设备缓存爆栈，数据丢包。

- 差错控制（Error control）：检测并重传损坏或丢失帧，并避免重复帧。

- 访问（接入）控制（Access control）：在任一给定时刻决定哪个设备拥有链路（物理介质）控制使用权。


**2.4、第三层网络层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image034.gif)

- 负责源主机到目的主机数据分组（packet）交付：可能会跨越多个网络，所以跨越网络时只有物理寻址不能保证能准确交付。

- 逻辑寻址（Logical addressing）：全局唯一逻辑地址，确保数据分组被送达目的主机，如IP地址。

- 路由（Routing）：路由器(或网关)互连网络，并路由分组至最终目的主机。以及路径的选择。

- 分组转发：

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image036.gif)


**2.5、第四层传输层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image038.gif)

- 负责源-目的（端-端）（进程间）完整报文传输。

- 报文的分段于重组：数据分组与组装。

- SAP寻址：进程与进程之间的一个地址。确保将完整报文提交给正确的进程，如端口号。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image040.gif)

- 连接控制：逻辑连接

- 流量控制：端到端之间的流量速度控制

- 差错控制：传输层的差错控制。


**2.6、第五层会话层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image042.gif)

- 负责对话的控制（log controlling）：建立与维护。

- 同步（synchronization）：在数据流中插入“同步点”：当一段的通话突然终止后，在下次连接时可以直接恢复到该同步点。

- 会话层是最“薄”的一层。


**2.7、第六层表示层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image044.gif)

- 负责处理两个系统间交换信息的语法与语义（syntax and semantics）问题。

- 数据表示转化：转换为主机独立的编码。

- 加密/解密、压缩/解压。


**2.8、第七层应用层功能：**

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image046.gif)

- 负责支持用户通过用户代理（如浏览器）或网络接口使用网络（服务）。

- 典型的应用层服务：FTP文件传输应用、HttpWeb应用等。


（3）TCP/IP参考模型：

1、概念：

- TCP/IP最早是先有协议再有模型。

- 只要能封装IP分组就可以完善整个传输路径。

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image048.gif)


![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image050.gif)

2、五层参考模型：

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image052.gif)

- 综合OSI和TCP/IP的优点。

- 应用层：支持各种网络应用，如：FTP、SMTP、HTTP

- 传输层：进程-进程的数据传输，如：TCP、UDP

- 网络层：源主机到目的主机的数据分组路由与转发，如：IP协议、路由协议等

- 链路层：相邻网络元素（主机、交换机、路由器等）的数据传输，如：以太网（Ethernet）、802.11(WiFi)、PPP

- 物理层：比特传输


2.1、五层模型的数据封装：

![clipboard.png](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80.assets/clip_image054.gif)

- 过程：

    - 源主机应用层->源主机传输层：报文->头部添加一个 段（segment）。

    - 源主机传输层->源主机网络层：报文.段->头部继续添加一个表示 = 数据报（datagram）。

    - 源主机网络层->源主机链路层：数据报->加头加尾 = 数据帧（frame）。

    - 源主机链路层->源主机物理层->交换机物理层->交换机链路层->路由器物理层->路由器网络层：还原到数据报形式。

    - 路由器网络层->.....->目的主机应用层：通过解析最终还原成报文。

 

